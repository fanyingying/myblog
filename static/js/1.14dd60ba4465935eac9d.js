webpackJsonp([1],{MVI7:function(t,e){t.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxMiIgdmlld0JveD0iMCAwIDE4IDEyIj4KICAgIDxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTS0zLTZoMjR2MjRILTN6Ii8+CiAgICAgICAgPHBhdGggZmlsbD0iIzRCNTk1RiIgZmlsbC1ydWxlPSJub256ZXJvIiBkPSJNMTggNUgzLjgzbDMuNTgtMy41OUw2IDAgMCA2bDYgNiAxLjQxLTEuNDFMMy44MyA3SDE4eiIvPgogICAgPC9nPgo8L3N2Zz4K"},ZAF6:function(t,e){},nxSB:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n("Dd8w"),i=n.n(s),o=n("NYxO"),a={data:function(){return{renderedMarkdown:""}},props:["comment"],methods:{renderMarkdown:function(){this.renderedMarkdown="",this.comment.body_html?this.renderedMarkdown=this.comment.body_html:this.comment.body&&(this.renderedMarkdown=this.$marked(this.comment.body))},openGitHub:function(){window.open(this.comment.user.html_url)}},mounted:function(){var t=this;this.$nextTick(function(){t.renderMarkdown()})}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment"},[n("div",{staticClass:"comment-title"},[n("div",{on:{click:function(e){t.openGitHub()}}},[n("img",{attrs:{src:t.comment.user.avatar_url}}),t._v(" "),n("span",[t._v(t._s(t.comment.user.login))])]),t._v(" "),n("span",{staticClass:"time"},[t._v(t._s(t.$moment(t.comment.created_at).format("YYYY-MM-DD HH:mm")))])]),t._v(" "),n("article",{staticClass:"comment-body markdown-body",domProps:{innerHTML:t._s(t.renderedMarkdown)}})])},staticRenderFns:[]},r=n("VU/8")(a,c,!1,null,null,null).exports,m={props:{commentsUrl:{type:String,required:!0}},data:function(){return{isWrite:!0,newComment:null,renderedMarkdown:"",isCommitting:!1}},computed:i()({},Object(o.c)(["accessToken","loginLink"]),{commentBtnDisabled:function(){return null==this.accessToken||this.isCommitting||null==this.newComment||0===this.newComment.trim().length}}),methods:i()({},Object(o.b)(["setAccessToken","setTokenUser"]),{renderMarkdown:function(){this.renderedMarkdown="Nothing to preview",this.newComment&&(this.renderedMarkdown=this.$marked(this.newComment)),this.isWrite=!1},fetchAccessToken:function(){var t=this,e=this.$queryParse();if(e.code){var n=e.code;delete e.code;var s=""+window.location.origin+window.location.pathname+this.$queryStringify(e)+window.location.hash;history.replaceState(null,null,s),this.$gitHubApi.getAccessToken(this,n).then(function(e){e.data&&e.data.access_token&&t.setAccessToken(e.data.access_token)})}},addComment:function(){var t=this;this.isCommitting=!0,this.$gitHubApi.addComment(this,this.commentsUrl,this.newComment.trim()).then(function(e){e.data&&e.data&&(t.$emit("addCommentSuccess",e.data),t.isWrite=!0,t.newComment=null,t.renderedMarkdown="",t.isCommitting=!1)}).catch(function(e){t.isCommitting=!1,e.response&&401===e.response.status&&t.setAccessToken(null)})}}),mounted:function(){var t=this;this.$nextTick(function(){t.fetchAccessToken()})}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"add-comment-container"},[n("div",{staticClass:"tab-container"},[n("ul",[n("li",{class:t.isWrite?"active":"",on:{click:function(e){t.isWrite=!0}}},[t._v("Write")]),t._v(" "),n("li",{class:t.isWrite?"":"active",on:{click:t.renderMarkdown}},[t._v("Preview")])]),t._v(" "),null==t.accessToken?n("div",[n("a",{attrs:{href:t.loginLink}},[t._v("Login")]),t._v(" with GitHub\n    ")]):t._e()]),t._v(" "),t.isWrite?n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newComment,expression:"newComment"}],attrs:{disabled:null==t.accessToken,rows:"5",placeholder:"说点什么？「支持 MarkDown 语法」"},domProps:{value:t.newComment},on:{input:function(e){e.target.composing||(t.newComment=e.target.value)}}}):n("article",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.renderedMarkdown)}}),t._v(" "),n("button",{staticClass:"add-comment-btn",attrs:{disabled:t.commentBtnDisabled},on:{click:t.addComment}},[t._v("Comment\n  ")])])},staticRenderFns:[]};var u={data:function(){return{issue:null,number:null,comments:[],newComment:null}},components:{Comment:r,AddComment:n("VU/8")(m,d,!1,function(t){n("ZAF6")},"data-v-5f154bd6",null).exports},methods:i()({},Object(o.b)(["updateActiveLabel"]),{setActiveLabel:function(t){this.updateActiveLabel(t),this.$router.push("/")},getComments:function(){var t=this;this.issue&&this.issue.comments>0&&this.$gitHubApi.getComments(this,this.issue.comments_url).then(function(e){t.comments=e.data})},getIssue:function(){var t=this;this.$gitHubApi.getIssue(this,this.number).then(function(e){t.issue=e.data,t.getComments()})},back:function(){this.$router.go(-1)},handleAddCommentSuccess:function(t){var e=this;this.comments.push(t),this.$nextTick(function(){setTimeout(function(){var t=e.$refs.commentContainer;t.scrollTop=t.scrollHeight-t.clientHeight},16)})}}),created:function(){this.$route.params.issue?this.issue=this.$route.params.issue:this.$route.params.number?this.number=this.$route.params.number:this.$router.replace("/")},mounted:function(){var t=this;this.$nextTick(function(){t.issue?t.getComments():t.getIssue()})}},l={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.issue?s("div",{staticClass:"blog-detail-container"},[s("div",{staticClass:"title-container"},[s("span",{staticClass:"title"},[t._v(t._s(t.issue.title))]),t._v(" "),s("ul",t._l(t.issue.labels,function(e){return s("li",{key:e.id,staticClass:"tag tag-small",style:{backgroundColor:"#"+e.color},on:{click:function(n){t.setActiveLabel(e)}}},[t._v(t._s(e.name)+"\n      ")])})),t._v(" "),s("span",{staticClass:"back",on:{click:t.back}},[s("img",{staticClass:"back-icon",attrs:{src:n("MVI7")}}),t._v("返回\n    ")])]),t._v(" "),s("div",{ref:"commentContainer",staticClass:"comment-container bga-back-top"},[s("comment",{attrs:{comment:t.issue}}),t._v(" "),t._l(t.comments,function(t){return s("comment",{key:t.id,attrs:{comment:t}})}),t._v(" "),s("add-comment",{attrs:{commentsUrl:t.issue.comments_url},on:{addCommentSuccess:t.handleAddCommentSuccess}})],2)]):t._e()},staticRenderFns:[]},h=n("VU/8")(u,l,!1,null,null,null);e.default=h.exports}});
//# sourceMappingURL=1.14dd60ba4465935eac9d.js.map